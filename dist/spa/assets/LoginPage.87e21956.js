import{k as _,r as h,V as w,ai as I,aj as z,o as R,h as $,l as j,g as Z,ak as K,K as Q,q as L,al as N,am as O,i as D,an as G,d as M,ao as T,a2 as U,a5 as W,a6 as H,a7 as u,f as o,ap as q,aq as J,a9 as X,ar as C,as as k,ac as S,a8 as B,at as Y}from"./index.02ec05f5.js";import{Q as ee}from"./QPage.bb8a0928.js";var te=_({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(d,{slots:x,emit:m}){const p=Z(),i=h(null);let l=0;const r=[];function y(e){const f=typeof e=="boolean"?e:d.noErrorFocus!==!0,F=++l,V=(a,s)=>{m(`validation${a===!0?"Success":"Error"}`,s)},P=a=>{const s=a.validate();return typeof s.then=="function"?s.then(c=>({valid:c,comp:a}),c=>({valid:!1,comp:a,err:c})):Promise.resolve({valid:s,comp:a})};return(d.greedy===!0?Promise.all(r.map(P)).then(a=>a.filter(s=>s.valid!==!0)):r.reduce((a,s)=>a.then(()=>P(s).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return F===l&&V(!0),!0;if(F===l){const{comp:s,err:c}=a[0];if(c!==void 0&&console.error(c),V(!1,s),f===!0){const A=a.find(({comp:E})=>typeof E.focus=="function"&&K(E.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function b(){l++,r.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function g(e){e!==void 0&&Q(e);const f=l+1;y().then(F=>{f===l&&F===!0&&(d.onSubmit!==void 0?m("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function v(e){e!==void 0&&Q(e),m("reset"),L(()=>{b(),d.autofocus===!0&&d.noResetFocus!==!0&&t()})}function t(){N(()=>{if(i.value===null)return;const e=i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),f=>f.tabIndex!==-1);e!=null&&e.focus({preventScroll:!0})})}w(O,{bindComponent(e){r.push(e)},unbindComponent(e){const f=r.indexOf(e);f!==-1&&r.splice(f,1)}});let n=!1;return I(()=>{n=!0}),z(()=>{n===!0&&d.autofocus===!0&&t()}),R(()=>{d.autofocus===!0&&t()}),Object.assign(p.proxy,{validate:y,resetValidation:b,submit:g,reset:v,focus:t,getValidationComponents:()=>r}),()=>$("form",{class:"q-form",ref:i,onSubmit:g,onReset:v},j(x.default))}});function ae(){return D(G)}const se=M({__name:"LoginPage",setup(d){const x=ae(),m=T(),p=U(),i=h(""),l=h(""),r=h(!0);p.checkLogin().then(()=>{p.isAuthenticated&&m.push("/dashboard")});const y=v=>/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/.test(v)||"Correo electr\xF3nico inv\xE1lido",b=async()=>{try{await p.login(i.value,l.value),m.push("/dashboard")}catch{x.notify({color:"negative",message:"Error de autenticaci\xF3n. Por favor, verifica tus credenciales.",icon:"report_problem"})}},g=()=>{x.notify({color:"info",message:"Funci\xF3n de recuperaci\xF3n de contrase\xF1a no implementada.",icon:"info"})};return(v,t)=>(W(),H(ee,{class:"auth-container"},{default:u(()=>[o(Y,{class:"auth-card"},{default:u(()=>[o(q,{class:"text-center"},{default:u(()=>[o(J,{size:"80px","font-size":"40px",color:"primary","text-color":"white"},{default:u(()=>t[3]||(t[3]=[X(" GW ")])),_:1}),t[4]||(t[4]=C("div",{class:"text-h5 q-mt-md text-primary"},"GreenWiser App",-1)),t[5]||(t[5]=C("div",{class:"text-subtitle1 q-mt-sm"},"Monitoreo de Recolecci\xF3n de residuos",-1))]),_:1}),o(q,null,{default:u(()=>[o(te,{onSubmit:b,class:"q-gutter-md"},{default:u(()=>[o(k,{filled:"",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),label:"Correo electr\xF3nico",type:"email",rules:[n=>!!n||"El correo es requerido",y]},{prepend:u(()=>[o(S,{name:"email",color:"primary"})]),_:1},8,["modelValue","rules"]),o(k,{filled:"",modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value=n),label:"Contrase\xF1a",type:r.value?"password":"text",rules:[n=>!!n||"La contrase\xF1a es requerida"]},{prepend:u(()=>[o(S,{name:"lock",color:"primary"})]),append:u(()=>[o(S,{name:r.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:t[1]||(t[1]=n=>r.value=!r.value),color:"primary"},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),C("div",null,[o(B,{label:"Iniciar sesi\xF3n",type:"submit",color:"primary",class:"full-width q-py-sm"})])]),_:1})]),_:1}),o(q,{class:"text-center q-pa-none"},{default:u(()=>[o(B,{flat:"",color:"primary",label:"\xBFOlvidaste tu contrase\xF1a?",onClick:g})]),_:1})]),_:1})]),_:1}))}});export{se as default};
